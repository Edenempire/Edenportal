<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compliance CV-7</title>

<link rel="icon" type="image/png" href="logo.png">

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">

<style>

/* ===========================
ROOT
=========================== */

:root{

--bg:#000;
--panel:#050505;
--red:#ff0033;
--green:#00ff41;
--text:#ff0033;

--font1:'Orbitron',sans-serif;
--font2:'JetBrains Mono',monospace;

}

/* ===========================
BASE
=========================== */

*{
box-sizing:border-box;
margin:0;
padding:0;
}

body{

background:#000;
color:var(--red);
font-family:var(--font2);
overflow-x:hidden;

}

/* ===========================
HEADER
=========================== */

header{

position:sticky;
top:0;
background:#000;
padding:20px;
text-align:center;
border-bottom:1px solid var(--red);
z-index:1000;

}

header h1{

font-family:var(--font1);
letter-spacing:6px;

}

/* ===========================
MAIN
=========================== */

main{

padding:20px;
max-width:1400px;
margin:auto;

}

/* ===========================
SECTION
=========================== */

.section{

margin-bottom:40px;
border:1px solid #111;
padding:20px;
background:#050505;

}

.section h2{

margin-bottom:15px;
font-family:var(--font1);

}

/* ===========================
PANELS
=========================== */

.panel{

margin-top:15px;

}

/* ===========================
INPUTS
=========================== */

textarea,
input{

width:100%;
background:#000;
border:1px solid #111;
color:var(--green);
padding:10px;
margin-bottom:10px;
font-family:var(--font2);

}

textarea{

min-height:120px;

}

/* ===========================
BUTTONS
=========================== */

button{

padding:10px;
margin-top:5px;
margin-right:5px;
border:none;
cursor:pointer;
font-family:var(--font2);

}

.save{

background:#222;
color:#fff;

}

.send{

background:var(--green);
color:#000;
font-weight:bold;

}

.delete{

background:#500;
color:#fff;

}

/* ===========================
OUTPUT
=========================== */

.output{

margin-top:15px;
padding:10px;
border:1px solid var(--green);
min-height:40px;
color:var(--green);

}

/* ===========================
CHECKLIST
=========================== */

.task{

display:flex;
gap:10px;
margin-bottom:5px;

}

.task input[type=text]{

flex:1;

}

/* ===========================
FOOTER
=========================== */

footer{

padding:30px;
text-align:center;
border-top:1px solid var(--red);
margin-top:50px;

}

/* ===========================
LOADING
=========================== */

.loading{

position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:#000;
display:none;
align-items:center;
justify-content:center;
z-index:9999;

}

.loading.show{

display:flex;

}

.loader{

border:3px solid #111;
border-top:3px solid var(--green);
width:40px;
height:40px;
border-radius:50%;
animation:spin 1s linear infinite;

}

@keyframes spin{

100%{transform:rotate(360deg)}

}

/* ===========================
TOAST
=========================== */

.toast{

position:fixed;
bottom:20px;
right:20px;
background:#000;
border:1px solid var(--green);
padding:10px;
display:none;
color:var(--green);

}

.toast.show{

display:block;

}

/* ===========================
GLITCH BACKGROUND
=========================== */

canvas{

position:fixed;
top:0;
left:0;
z-index:-1;

}

  .task-list{
  margin-top:10px;
}

.task-item{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px;
  margin-bottom:6px;
  background:#020202;
  border:1px solid #111;
  transition:all .3s ease;
  animation:fadeIn .3s ease;
}

.task-item:hover{
  background:#111;
}

.task-text.checked{
  text-decoration:line-through;
  opacity:.6;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(-5px);}
  to{opacity:1; transform:translateY(0);}
}

.mini-section{
  margin-top:20px;
}

  @media(max-width:600px){

  .task-item{
    flex-wrap:wrap;
  }

  .task-item button{
    flex:1;
  }

  .task-creator{
    display:flex;
    flex-direction:column;
    gap:10px;
  }

}

  .upload-box{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:20px;
}

.intel-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:15px;
}

.file-card{
  border:1px solid #111;
  padding:10px;
  background:#020202;
  animation:fadeIn .3s ease;
}

.file-card img,
.file-card video{
  width:100%;
  max-height:200px;
  object-fit:cover;
}

.preview audio{
  width:100%;
}

</style>
</head>
<body>

<canvas id="glitch"></canvas>

<header>

<h1><a href="/index.html" style="text-decoration: none; color: #ff0033;" title="back to home...">COMPLIANCE CV-7</a></h1>

</header>

<div class="loading" id="loading">
<div class="loader"></div>
</div>

<div class="toast" id="toast"></div>

<main>

<!-- SECTION 1 -->

<div class="section">

<h2>SECTION 1 — TARGET</h2>

<textarea id="s1_input">
  Target: money (R5000 into P&P business bank account every end of the month)
  <br>
  Execution: Parables & Platters
  Routes: ends EAST stalwart semelane street... flank endings are NORTH ke masinga and SOUTH harbour... then WEST, the market...
  Rules: deposits are only done @ 320 west street
  Logic: 6 units a day = R150 a day / R100 into Parables & Platters business bank account
  Cooking starts: 04:00am every morning
  -------
  TYPE WHAT YOU NEED TO TYPE BELOW...
  -------
</textarea>

<button class="save" onclick="save(1)">SAVE</button>

<button class="send" onclick="send(1)">SEND</button>

<div class="output" id="s1_output"></div>

</div>

  <!-- SECTION 2 -->

  <div class="section">

<h2>SECTION 2 — CHECKLIST</h2>

<!-- TASK CREATOR -->
<div class="task-creator">
  <input id="taskInput" placeholder="Add a task... cipc, embassies, illegalities, taxi association">
  <button class="save" onclick="addTask()">ADD</button>
</div>

<!-- MINI SECTIONS -->
<div class="mini-section">
  <h3>ACTIVE TASKS</h3>
  <div id="activeTasks" class="task-list"></div>
</div>

<div class="mini-section">
  <h3>COMPLETED TASKS</h3>
  <div id="completedTasks" class="task-list"></div>
</div>

</div>

<!-- SECTION 3 -->

<div class="section">

<h2>SECTION 3 — INTEL LOG</h2>

<div class="upload-box">

  <input type="file" id="fileInput" multiple>
  <textarea id="fileNote" placeholder="Add note for these files..."></textarea>

  <button class="save" onclick="uploadFiles()">UPLOAD (MAX 7)</button>

</div>

<div id="intelLog" class="intel-grid"></div>

</div>

<!-- SECTION 4 -->

<div class="section">

<h2>SECTION 4 — n/a</h2>

<textarea id="s4_input"></textarea>

<button class="save" onclick="save(4)">SAVE</button>

<button class="send" onclick="send(4)">SEND</button>

<div class="output" id="s4_output"></div>

</div>


<!-- SECTION 5 -->

<div class="section">

<h2>SECTION 5 — n/a</h2>

<textarea id="s5_input"></textarea>

<button class="save" onclick="save(5)">SAVE</button>

<button class="send" onclick="send(5)">SEND</button>

<div class="output" id="s5_output"></div>

</div>


<!-- SECTION 6 -->

<div class="section">

<h2>SECTION 6 — n/a</h2>

<textarea id="s6_input"></textarea>

<button class="save" onclick="save(6)">SAVE</button>

<button class="send" onclick="send(6)">SEND</button>

<div class="output" id="s6_output"></div>

</div>


<!-- SECTION 7 -->

<div class="section">

<h2>SECTION 7 — ZAMA MDLULI (AI)</h2>

<input id="ai_input">

<button class="send" onclick="ai()">SEND</button>

<div class="output" id="ai_output"></div>

</div>


</main>

<footer>

"The Lord is my light and my salvation; whom shall I fear?" — Psalm 27:1 KJV

</footer>

  <script type="module">

/* =====================================================
   FIREBASE INITIALIZATION
===================================================== */

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import {
  getFirestore,
  doc, setDoc, getDoc, updateDoc, deleteDoc,
  collection, addDoc, onSnapshot,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCD2-b7h5lbfjybVWH1_b6Caii0ZFdnMYM",
  authDomain: "eden-15b5e.firebaseapp.com",
  projectId: "eden-15b5e",
  storageBucket: "eden-15b5e.firebasestorage.app",
  messagingSenderId: "527375997812",
  appId: "1:527375997812:web:bf8bb59ebd243131d3ea21"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* =====================================================
   LOCAL BACKUP SYSTEM
===================================================== */

const BACKUP_KEY = "CV7_FIRESTORE_BACKUP";

function backup(data){
  localStorage.setItem(BACKUP_KEY, JSON.stringify(data));
}

function loadBackup(){
  try{
    return JSON.parse(localStorage.getItem(BACKUP_KEY)) || {};
  }catch{
    return {};
  }
}

/* =====================================================
   COLLECTION REFERENCES
===================================================== */

const sectionsCol = collection(db, "compliance_sections");
const outputsCol  = collection(db, "compliance_outputs");
const tasksCol    = collection(db, "compliance_tasks");
const intelCol    = collection(db, "compliance_intel");
const metaDoc     = doc(db, "compliance_meta", "system");
const aiDoc       = doc(db, "compliance_meta", "ai");

/* =====================================================
   SECTIONS CRUD
===================================================== */

window.save = async function(id){
  const textarea = document.getElementById("s"+id+"_input");
  const content = textarea.value;

  await setDoc(doc(db,"compliance_sections","s"+id),{
    content,
    updated: serverTimestamp()
  });

  mirrorBackup();
  toast("Section Saved");
};

function loadSections(){
  onSnapshot(sectionsCol,(snap)=>{
    snap.forEach(d=>{
      const el = document.getElementById(d.id+"_input");
      if(el) el.value = d.data().content;
    });
    mirrorBackup();
  });
}

/* =====================================================
   OUTPUTS CRUD
===================================================== */

window.send = async function(id){
  const input = document.getElementById("s"+id+"_input").value;
  const output = document.getElementById("s"+id+"_output");

  output.innerText = input;

  await setDoc(doc(db,"compliance_outputs","s"+id+"_output"),{
    content:input,
    updated: serverTimestamp()
  });

  mirrorBackup();
  toast("Sent");
};

function loadOutputs(){
  onSnapshot(outputsCol,(snap)=>{
    snap.forEach(d=>{
      const el = document.getElementById(d.id);
      if(el) el.innerText = d.data().content;
    });
  });
}

/* =====================================================
   TASKS CRUD
===================================================== */

window.addTask = async function(){
  const value = taskInput.value.trim();
  if(!value) return;

  await addDoc(tasksCol,{
    text:value,
    completed:false,
    created: serverTimestamp()
  });

  taskInput.value="";
};

function renderTask(id,data){
  const div=document.createElement("div");
  div.className="task-item";

  div.innerHTML=`
    <input type="checkbox" ${data.completed?"checked":""}>
    <span class="task-text ${data.completed?"checked":""}">
      ${data.text}
    </span>
    <button>✎</button>
    <button class="delete">X</button>
  `;

  div.querySelector("input").onchange = async ()=>{
    await updateDoc(doc(db,"compliance_tasks",id),{
      completed:!data.completed
    });
  };

  div.querySelector("button").onclick = async ()=>{
    const newText = prompt("Edit:",data.text);
    if(!newText) return;
    await updateDoc(doc(db,"compliance_tasks",id),{
      text:newText
    });
  };

  div.querySelector(".delete").onclick = async ()=>{
    await deleteDoc(doc(db,"compliance_tasks",id));
  };

  return div;
}

function loadTasks(){
  onSnapshot(tasksCol,(snap)=>{
    activeTasks.innerHTML="";
    completedTasks.innerHTML="";

    snap.forEach(d=>{
      const el = renderTask(d.id,d.data());
      if(d.data().completed)
        completedTasks.appendChild(el);
      else
        activeTasks.appendChild(el);
    });
  });
}

/* =====================================================
   INTEL CRUD (METADATA)
===================================================== */

window.uploadFiles = async function(){
  const files = fileInput.files;
  if(!files.length) return;

  for(let f of files){
    await addDoc(intelCol,{
      name:f.name,
      type:f.type,
      note:fileNote.value || "",
      created:serverTimestamp()
    });
  }

  fileInput.value="";
  fileNote.value="";
};

function loadIntel(){
  onSnapshot(intelCol,(snap)=>{
    intelLog.innerHTML="";
    snap.forEach(d=>{
      const div=document.createElement("div");
      div.className="file-card";
      div.innerHTML=`
        <strong>${d.data().name}</strong>
        <p>${d.data().note || ""}</p>
        <button class="delete">DELETE</button>
      `;
      div.querySelector(".delete").onclick = async ()=>{
        await deleteDoc(doc(db,"compliance_intel",d.id));
      };
      intelLog.appendChild(div);
    });
  });
}

/* =====================================================
   AI CRUD
===================================================== */

window.ai = async function(){
  const cmd = ai_input.value;
  let res="UNKNOWN";

  if(cmd.toLowerCase().includes("status"))
    res="ALL SYSTEMS READY";

  await setDoc(aiDoc,{
    input:cmd,
    output:res,
    updated:serverTimestamp()
  });
};

function loadAI(){
  onSnapshot(aiDoc,(snap)=>{
    if(!snap.exists()) return;
    ai_input.value = snap.data().input || "";
    ai_output.innerText = snap.data().output || "";
  });
}

/* =====================================================
   SYSTEM META (SCROLL + VERSION)
===================================================== */

window.addEventListener("scroll", async ()=>{
  await setDoc(metaDoc,{
    scroll:window.scrollY,
    updated:serverTimestamp()
  },{merge:true});
});

function loadMeta(){
  onSnapshot(metaDoc,(snap)=>{
    if(!snap.exists()) return;
    setTimeout(()=>{
      window.scrollTo(0,snap.data().scroll || 0);
    },200);
  });
}

/* =====================================================
   BACKUP MIRROR
===================================================== */

async function mirrorBackup(){
  const snapshot = {
    sections:[],
    outputs:[],
    tasks:[]
  };

  const sSnap = await getDoc(metaDoc);
  snapshot.meta = sSnap.exists()?sSnap.data():{};

  backup(snapshot);
}

/* =====================================================
   TOAST
===================================================== */

function toast(msg){
  const t=document.getElementById("toast");
  t.innerText=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2000);
}

/* =====================================================
   INIT
===================================================== */

loadSections();
loadOutputs();
loadTasks();
loadIntel();
loadAI();
loadMeta();

</script>

</body>
</html>


















